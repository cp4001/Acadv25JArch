<UserControl x:Class="PipeLoadAnalysis.PipeTreeViewV2"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="400"
             Background="White">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 상단 정보 패널 -->
        <Border Grid.Row="0" Background="#FF4682B4" Padding="10">
            <StackPanel>
                <TextBlock Text="배관 네트워크 구조 (Line 기반)" 
                          FontSize="16" 
                          FontWeight="Bold" 
                          Foreground="White"
                          Margin="0,0,0,5"/>
                <TextBlock x:Name="txtStatistics" 
                          FontSize="11" 
                          Foreground="White"
                          TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <!-- TreeView 영역 -->
        <Border Grid.Row="1" BorderBrush="#FFCCCCCC" BorderThickness="1">
            <TreeView x:Name="treeView" 
                     FontSize="11"
                     Padding="5"
                     SelectedItemChanged="TreeView_SelectedItemChanged"
                     MouseDoubleClick="TreeView_MouseDoubleClick">
                <TreeView.Resources>
                    <!-- TreeViewItem 스타일 -->
                    <Style TargetType="TreeViewItem">
                        <Setter Property="IsExpanded" Value="True"/>
                        <Setter Property="Padding" Value="3"/>
                    </Style>
                </TreeView.Resources>
                
                <!-- ItemTemplate 정의 -->
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal">
                            <!-- 아이콘 -->
                            <Ellipse Width="10" Height="10" 
                                    Fill="{Binding NodeColor}" 
                                    Margin="0,0,5,0"/>
                            <!-- 텍스트 -->
                            <TextBlock Text="{Binding DisplayText}" 
                                      Foreground="{Binding TextColor}"
                                      FontWeight="{Binding FontWeight}"/>
                        </StackPanel>
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Border>

        <!-- 하단 범례 패널 -->
        <Border Grid.Row="2" Background="#FFF5F5F5" Padding="10" BorderBrush="#FFCCCCCC" BorderThickness="0,1,0,0">
            <StackPanel>
                <TextBlock Text="범례" FontSize="10" FontWeight="Bold" Margin="0,0,0,5"/>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,3">
                    <Ellipse Width="10" Height="10" Fill="Red" Margin="0,0,5,0"/>
                    <TextBlock Text="Root Line" FontSize="10"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,3">
                    <Ellipse Width="10" Height="10" Fill="Blue" Margin="0,0,5,0"/>
                    <TextBlock Text="중간 Line" FontSize="10"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <Ellipse Width="10" Height="10" Fill="Green" Margin="0,0,5,0"/>
                    <TextBlock Text="Leaf Line (말단)" FontSize="10"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
